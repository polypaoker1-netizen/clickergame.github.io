# ===== MPTHAMST BOT (Telegram) =====
import asyncio
from aiogram import Bot, Dispatcher, types
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton, WebAppInfo
import sqlite3
import random
import time
from datetime import datetime, timedelta
import hashlib
import json

# ===== –ë–ê–ó–ê –î–ê–ù–ù–´–• =====
db = sqlite3.connect('mpthamst.db', check_same_thread=False)
cursor = db.cursor()

cursor.execute('''
CREATE TABLE IF NOT EXISTS players (
    user_id INTEGER PRIMARY KEY,
    username TEXT,
    rank TEXT DEFAULT 'Bronze',
    rank_progress INTEGER DEFAULT 1,
    hourly_income INTEGER DEFAULT 93,
    balance INTEGER DEFAULT 1456,
    energy INTEGER DEFAULT 962,
    energy_max INTEGER DEFAULT 1000,
    last_click_time INTEGER,
    last_daily_time INTEGER,
    last_cipher_time INTEGER,
    last_combo_time INTEGER,
    total_clicks INTEGER DEFAULT 0,
    boost_active INTEGER DEFAULT 0,
    boost_ends INTEGER DEFAULT 0,
    photo_id TEXT,
    created_at INTEGER
)
''')

cursor.execute('''
CREATE TABLE IF NOT EXISTS friends (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    friend_id INTEGER,
    UNIQUE(user_id, friend_id)
)
''')

cursor.execute('''
CREATE TABLE IF NOT EXISTS transactions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    amount INTEGER,
    type TEXT,
    timestamp INTEGER
)
''')
db.commit()

# ===== –ö–û–ù–°–¢–ê–ù–¢–´ =====
API_TOKEN = '8320847269:AAGl0lhSUxEsILG3AQMlOQRqVbRnMglxaFs'
bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)

WEBAPP_URL = "https://–≤–∞—à-—Å–∞–π—Ç.com/mpthamst"  # URL –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

RANKS = {
    'Bronze': {'income': 93, 'max_progress': 10, 'next': 'Silver'},
    'Silver': {'income': 250, 'max_progress': 10, 'next': 'Gold'},
    'Gold': {'income': 600, 'max_progress': 10, 'next': 'Platinum'},
    'Platinum': {'income': 15700, 'max_progress': 10, 'next': 'Diamond'}
}

# ===== –Ø–î–†–û –ò–ì–†–´ =====
class MPThamstGame:
    @staticmethod
    def get_user(user_id, username=None, photo_id=None):
        cursor.execute('SELECT * FROM players WHERE user_id = ?', (user_id,))
        user = cursor.fetchone()
        
        if not user:
            cursor.execute('''
                INSERT INTO players 
                (user_id, username, rank, rank_progress, hourly_income, balance, 
                 energy, energy_max, last_click_time, created_at, photo_id)
                VALUES (?, ?, 'Bronze', 1, 93, 1456, 962, 1000, ?, ?, ?)
            ''', (user_id, username, int(time.time()), int(time.time()), photo_id))
            db.commit()
            
            cursor.execute('SELECT * FROM players WHERE user_id = ?', (user_id,))
            user = cursor.fetchone()
        
        elif username and user[1] != username:
            cursor.execute('UPDATE players SET username = ? WHERE user_id = ?', (username, user_id))
            db.commit()
        
        return user
    
    @staticmethod
    async def click(user_id):
        cursor.execute('''
            SELECT balance, hourly_income, energy, energy_max, 
                   last_click_time, boost_active, boost_ends 
            FROM players WHERE user_id = ?
        ''', (user_id,))
        
        balance, income, energy, energy_max, last_time, boost_active, boost_ends = cursor.fetchone()
        
        now = int(time.time())
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏
        if energy <= 0:
            return False, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏! –ü–æ–¥–æ–∂–¥–∏—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è."
        
        # –†–∞—Å—á–µ—Ç –Ω–∞–≥—Ä–∞–¥—ã
        base_reward = income // 60  # –ü–µ—Ä–µ–≤–æ–¥–∏–º –≤ –º–∏–Ω—É—Ç—ã
        if boost_active and boost_ends > now:
            base_reward *= 2
        
        reward = max(1, base_reward)
        new_balance = balance + reward
        new_energy = energy - 1
        
        # –û–±–Ω–æ–≤–ª—è–µ–º
        cursor.execute('''
            UPDATE players 
            SET balance = ?, energy = ?, last_click_time = ?, total_clicks = total_clicks + 1
            WHERE user_id = ?
        ''', (new_balance, new_energy, now, user_id))
        
        # –õ–æ–≥–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        cursor.execute('''
            INSERT INTO transactions (user_id, amount, type, timestamp)
            VALUES (?, ?, 'click', ?)
        ''', (user_id, reward, now))
        
        db.commit()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–Ω–≥–∞
        rank_data = MPThamstGame.check_rank_up(user_id)
        
        return True, {
            'reward': reward,
            'balance': new_balance,
            'energy': new_energy,
            'energy_max': energy_max,
            'rank_up': rank_data
        }
    
    @staticmethod
    def check_rank_up(user_id):
        cursor.execute('SELECT rank, rank_progress, hourly_income FROM players WHERE user_id = ?', (user_id,))
        rank, progress, income = cursor.fetchone()
        
        if rank in RANKS:
            max_progress = RANKS[rank]['max_progress']
            if progress >= max_progress:
                next_rank = RANKS[rank]['next']
                if next_rank:
                    new_income = RANKS[next_rank]['income']
                    cursor.execute('''
                        UPDATE players 
                        SET rank = ?, rank_progress = 1, hourly_income = ?
                        WHERE user_id = ?
                    ''', (next_rank, new_income, user_id))
                    db.commit()
                    
                    return {
                        'old_rank': rank,
                        'new_rank': next_rank,
                        'new_income': new_income
                    }
        
        return None
    
    @staticmethod
    def claim_daily(user_id):
        cursor.execute('SELECT last_daily_time, balance FROM players WHERE user_id = ?', (user_id,))
        last_daily, balance = cursor.fetchone()
        
        now = int(time.time())
        
        if last_daily and (now - last_daily) < 86400:  # 24 —á–∞—Å–∞
            next_claim = last_daily + 86400
            wait_time = next_claim - now
            hours = wait_time // 3600
            minutes = (wait_time % 3600) // 60
            return False, f"‚è≥ –°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ —á–µ—Ä–µ–∑ {hours:02d}:{minutes:02d}"
        
        reward = random.randint(1000, 5000)
        new_balance = balance + reward
        
        cursor.execute('''
            UPDATE players SET balance = ?, last_daily_time = ? WHERE user_id = ?
        ''', (new_balance, now, user_id))
        
        cursor.execute('''
            INSERT INTO transactions (user_id, amount, type, timestamp)
            VALUES (?, ?, 'daily', ?)
        ''', (user_id, reward, now))
        
        db.commit()
        return True, f"üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞: +{reward} MPThamst Coins!"
    
    @staticmethod
    def claim_cipher(user_id):
        cursor.execute('SELECT last_cipher_time, balance FROM players WHERE user_id = ?', (user_id,))
        last_cipher, balance = cursor.fetchone()
        
        now = int(time.time())
        
        if last_cipher and (now - last_cipher) < 21600:  # 6 —á–∞—Å–æ–≤
            next_claim = last_cipher + 21600
            wait_time = next_claim - now
            hours = wait_time // 3600
            minutes = (wait_time % 3600) // 60
            return False, f"‚è≥ –°–ª–µ–¥—É—é—â–∏–π —à–∏—Ñ—Ä —á–µ—Ä–µ–∑ {hours:02d}:{minutes:02d}"
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è "—à–∏—Ñ—Ä–∞"
        cipher = hashlib.md5(f"{user_id}{now}".encode()).hexdigest()[:8].upper()
        reward = random.randint(500, 2000)
        new_balance = balance + reward
        
        cursor.execute('''
            UPDATE players SET balance = ?, last_cipher_time = ? WHERE user_id = ?
        ''', (new_balance, now, user_id))
        
        cursor.execute('''
            INSERT INTO transactions (user_id, amount, type, timestamp)
            VALUES (?, ?, 'cipher', ?)
        ''', (user_id, reward, now))
        
        db.commit()
        return True, f"üîê –®–∏—Ñ—Ä: `{cipher}`\nüéØ –ù–∞–≥—Ä–∞–¥–∞: +{reward} coins!"
    
    @staticmethod
    def activate_boost(user_id):
        cursor.execute('SELECT balance, boost_ends FROM players WHERE user_id = ?', (user_id,))
        balance, boost_ends = cursor.fetchone()
        
        now = int(time.time())
        cost = 2500
        
        if balance < cost:
            return False, f"‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –ù—É–∂–Ω–æ: {cost}, —É –≤–∞—Å: {balance}"
        
        if boost_ends and boost_ends > now:
            return False, f"‚è≥ –ë—É—Å—Ç —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω! –ó–∞–≤–µ—Ä—à–∏—Ç—Å—è —á–µ—Ä–µ–∑ {(boost_ends - now) // 60} –º–∏–Ω."
        
        new_balance = balance - cost
        boost_ends = now + 3600  # 1 —á–∞—Å
        
        cursor.execute('''
            UPDATE players 
            SET balance = ?, boost_active = 1, boost_ends = ?
            WHERE user_id = ?
        ''', (new_balance, boost_ends, user_id))
        
        cursor.execute('''
            INSERT INTO transactions (user_id, amount, type, timestamp)
            VALUES (?, ?, 'boost', ?)
        ''', (user_id, -cost, now))
        
        db.commit()
        return True, f"‚ö° –ë—É—Å—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! 2x –¥–æ—Ö–æ–¥ –Ω–∞ 60 –º–∏–Ω—É—Ç!"
    
    @staticmethod
    def add_friend(user_id, friend_username):
        # –ù–∞—Ö–æ–¥–∏–º –¥—Ä—É–≥–∞
        cursor.execute('SELECT user_id FROM players WHERE username = ?', (friend_username,))
        friend = cursor.fetchone()
        
        if not friend:
            return False, "üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"
        
        friend_id = friend[0]
        
        if user_id == friend_id:
            return False, "‚ùå –ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è"
        
        try:
            cursor.execute('INSERT INTO friends (user_id, friend_id) VALUES (?, ?)', (user_id, friend_id))
            cursor.execute('INSERT INTO friends (user_id, friend_id) VALUES (?, ?)', (friend_id, user_id))
            
            # –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∞
            cursor.execute('UPDATE players SET balance = balance + 500 WHERE user_id IN (?, ?)', (user_id, friend_id))
            
            db.commit()
            return True, f"‚úÖ –î—Ä—É–≥ {friend_username} –¥–æ–±–∞–≤–ª–µ–Ω! +500 coins –∫–∞–∂–¥–æ–º—É!"
        except:
            return False, "üë• –í—ã —É–∂–µ –¥—Ä—É–∑—å—è"

# ===== –¢–ï–õ–ï–ì–†–ê–ú –ë–û–¢ =====
@dp.message_handler(commands=['start'])
async def start_game(message: types.Message):
    user = MPThamstGame.get_user(
        message.from_user.id, 
        message.from_user.username,
        photo_id=None  # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å photo_id –µ—Å–ª–∏ –µ—Å—Ç—å
    )
    
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
    keyboard = InlineKeyboardMarkup(row_width=2)
    
    buttons = [
        InlineKeyboardButton("üéÆ –û–¢–ö–†–´–¢–¨ MPTHAMST", web_app=WebAppInfo(url=WEBAPP_URL)),
        InlineKeyboardButton("üêπ –ö–õ–ò–ö–ù–£–¢–¨", callback_data='click'),
        InlineKeyboardButton("üéÅ –ï–ñ–ï–î–ù–ï–í–ù–ê–Ø", callback_data='daily'),
        InlineKeyboardButton("üîê –®–ò–§–†", callback_data='cipher'),
        InlineKeyboardButton("‚ö° –ë–£–°–¢", callback_data='boost'),
        InlineKeyboardButton("üë• –î–†–£–ó–¨–Ø", callback_data='friends'),
        InlineKeyboardButton("üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê", callback_data='stats'),
        InlineKeyboardButton("üèÜ –¢–û–ü", callback_data='top')
    ]
    
    keyboard.add(*buttons)
    
    await message.reply_photo(
        photo='https://–≤–∞—à-—Å–∞–π—Ç.com/–≤–∞—à–∞-—Ñ–æ—Ç–æ.jpg',  # –ó–∞–≥—Ä—É–∑–∏ —Å–≤–æ—é —Ñ–æ—Ç–æ
        caption=f'''
üéÆ *MPTHAMST - CLICKER GAME*

üë§ *–ò–≥—Ä–æ–∫:* {message.from_user.first_name}
üèÖ *–†–∞–Ω–≥:* {user[2]} > {user[3]}/10
üí∞ *–ë–∞–ª–∞–Ω—Å:* {user[5]:,} MPTC
‚ö° *–≠–Ω–µ—Ä–≥–∏—è:* {user[6]}/{user[7]}
üí∏ *–ü—Ä–∏–±—ã–ª—å –≤ —á–∞—Å:* +{user[4]:,}

*–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è –∏–≥—Ä—ã!*
–ò–ª–∏ –æ—Ç–∫—Ä–æ–π *–ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é* —á–µ—Ä–µ–∑ Web App!''',
        reply_markup=keyboard
    )

@dp.callback_query_handler(lambda c: c.data == 'click')
async def process_click(callback_query: types.CallbackQuery):
    success, result = await MPThamstGame.click(callback_query.from_user.id)
    
    if success:
        response = f'''
üêπ *–ö–õ–ò–ö!*

+{result['reward']} MPTC
üí∞ –ë–∞–ª–∞–Ω—Å: {result['balance']:,}
‚ö° –≠–Ω–µ—Ä–≥–∏—è: {result['energy']}/{result['energy_max']}

{result['rank_up']['message'] if result.get('rank_up') else "–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∫–ª–∏–∫–∞—Ç—å!"}
'''
    else:
        response = result
    
    await bot.answer_callback_query(callback_query.id, response, show_alert=True)

@dp.callback_query_handler(lambda c: c.data == 'daily')
async def claim_daily(callback_query: types.CallbackQuery):
    success, message = MPThamstGame.claim_daily(callback_query.from_user.id)
    await bot.answer_callback_query(callback_query.id, message, show_alert=True)

@dp.callback_query_handler(lambda c: c.data == 'cipher')
async def claim_cipher(callback_query: types.CallbackQuery):
    success, message = MPThamstGame.claim_cipher(callback_query.from_user.id)
    await bot.answer_callback_query(callback_query.id, message, show_alert=True)

@dp.callback_query_handler(lambda c: c.data == 'boost')
async def activate_boost(callback_query: types.CallbackQuery):
    success, message = MPThamstGame.activate_boost(callback_query.from_user.id)
    await bot.answer_callback_query(callback_query.id, message, show_alert=True)

# ===== –í–ï–ë-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï (HTML/CSS/JS) =====
web_app_html = """
<!DOCTYPE html>
<html>
<head>
    <title>MPTHamst - Clicker Game</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary: #6C63FF;
            --secondary: #4A44C6;
            --accent: #FF6584;
            --dark: #2A2D43;
            --light: #F5F5F7;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark) 0%, #1A1C2B 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .profile-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid var(--primary);
            margin: 0 auto 15px;
            background-size: cover;
            background-position: center;
            box-shadow: 0 10px 30px rgba(108, 99, 255, 0.3);
        }
        
        .rank-badge {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .stats-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .balance {
            font-size: 2.5em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: var(--accent);
            text-shadow: 0 2px 10px rgba(255, 101, 132, 0.3);
        }
        
        .click-area {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            height: 200px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 25px 0;
            cursor: pointer;
            user-select: none;
            transition: all 0.1s;
            position: relative;
            overflow: hidden;
        }
        
        .click-area:active {
            transform: scale(0.95);
        }
        
        .click-text {
            font-size: 2em;
            font-weight: bold;
            z-index: 2;
        }
        
        .click-effect {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: ripple 0.6s linear;
            pointer-events: none;
        }
        
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .energy-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }
        
        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #00FF88, #00CC6A);
            width: 50%;
            border-radius: 10px;
            transition: width 0.3s;
        }
        
        .buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            padding: 15px;
            border-radius: 15px;
            color: white;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }
        
        .btn-accent {
            background: linear-gradient(135deg, var(--accent), #FF3366);
        }
        
        .timer {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .progress-section {
            margin: 25px 0;
        }
        
        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .progress-bar {
            flex-grow: 1;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 0 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 5px;
        }
        
        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(42, 45, 67, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-around;
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.8em;
            transition: all 0.3s;
        }
        
        .nav-btn.active {
            color: var(--primary);
        }
        
        .nav-btn i {
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .container {
                padding-bottom: 80px;
            }
            
            .balance {
                font-size: 2em;
            }
            
            .click-area {
                height: 180px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="profile-img" id="profileImg"></div>
            <h1 id="playerName">MPTHamst Player</h1>
            <div class="rank-badge" id="rankBadge">
                <i class="fas fa-crown"></i>
                <span id="rankText">Bronze 1/10</span>
            </div>
        </div>
        
        <div class="stats-card">
            <div class="balance" id="balance">52,089</div>
            
            <div class="progress-section">
                <div class="progress-item">
                    <span>–ü—Ä–∏–±—ã–ª—å –≤ —á–∞—Å</span>
                    <span id="hourlyIncome">+15,7K</span>
                </div>
                <div class="energy-bar">
                    <div class="energy-fill" id="energyFill"></div>
                </div>
                <div style="text-align: center; font-size: 0.9em;">
                    <span id="energyText">962 / 1000</span>
                </div>
            </div>
        </div>
        
        <div class="click-area" id="clickArea">
            <div class="click-text">üêπ –ù–ê–ñ–ú–ò –ú–ï–ù–Ø!</div>
        </div>
        
        <div class="buttons-grid">
            <button class="btn btn-primary" id="dailyBtn">
                <i class="fas fa-gift"></i>
                –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
                <div class="timer" id="dailyTimer">14:37</div>
            </button>
            
            <button class="btn btn-primary" id="cipherBtn">
                <i class="fas fa-lock"></i>
                –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —à–∏—Ñ—Ä
                <div class="timer" id="cipherTimer">09:37</div>
            </button>
            
            <button class="btn btn-accent" id="boostBtn">
                <i class="fas fa-bolt"></i>
                Boost
                <div>2500 MPTC</div>
            </button>
            
            <button class="btn" id="friendsBtn">
                <i class="fas fa-users"></i>
                Friends
            </button>
        </div>
        
        <div class="stats-card">
            <h3><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="progress-item">
                <span>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</span>
                <span id="totalClicks">0</span>
            </div>
            <div class="progress-item">
                <span>–î—Ä—É–∑–µ–π</span>
                <span id="friendsCount">0</span>
            </div>
            <div class="progress-item">
                <span>–†–∞–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="rankProgress" style="width: 40%"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="navigation">
        <a href="#" class="nav-btn active">
            <i class="fas fa-home"></i>
            –ì–ª–∞–≤–Ω–∞—è
        </a>
        <a href="#" class="nav-btn">
            <i class="fas fa-exchange-alt"></i>
            –û–±–º–µ–Ω
        </a>
        <a href="#" class="nav-btn">
            <i class="fas fa-gem"></i>
            Mine
        </a>
        <a href="#" class="nav-btn">
            <i class="fas fa-user-friends"></i>
            Friends
        </a>
        <a href="#" class="nav-btn">
            <i class="fas fa-coins"></i>
            Earn
        </a>
    </div>
    
    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameData = {
            balance: 52089,
            energy: 962,
            energyMax: 1000,
            rank: "Platinum",
            rankProgress: 4,
            rankMax: 10,
            hourlyIncome: 15700,
            totalClicks: 0,
            friendsCount: 0,
            photoUrl: "https://–≤–∞—à-—Å–∞–π—Ç.com/–≤–∞—à–∞-—Ñ–æ—Ç–æ.jpg"
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ç–æ
            document.getElementById('profileImg').style.backgroundImage = `url(${gameData.photoUrl})`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
            document.getElementById('clickArea').addEventListener('click', function(e) {
                handleClick(e);
            });
            
            // –ö–Ω–æ–ø–∫–∏
            document.getElementById('dailyBtn').addEventListener('click', claimDaily);
            document.getElementById('cipherBtn').addEventListener('click', claimCipher);
            document.getElementById('boostBtn').addEventListener('click', activateBoost);
            document.getElementById('friendsBtn').addEventListener('click', showFriends);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä—ã
            updateTimers();
            setInterval(updateTimers, 60000);
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
            setInterval(restoreEnergy, 10000);
        });
        
        function handleClick(event) {
            if (gameData.energy <= 0) {
                showNotification("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!", "error");
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
            createClickEffect(event);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä—É
            gameData.energy--;
            gameData.totalClicks++;
            
            // –†–∞—Å—á–µ—Ç –Ω–∞–≥—Ä–∞–¥—ã
            let reward = Math.floor(gameData.hourlyIncome / 60);
            gameData.balance += reward;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω—è
            checkRankUp();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É
            showFloatingText(`+${reward}`, event.clientX, event.clientY);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –µ—Å—Ç—å)
            // sendClickToServer();
        }
        
        function createClickEffect(event) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.style.left = (event.offsetX - 25) + 'px';
            effect.style.top = (event.offsetY - 25) + 'px';
            document.getElementById('clickArea').appendChild(effect);
            
            setTimeout(() => effect.remove(), 600);
        }
        
        function claimDaily() {
            showNotification("üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞! +2500 MPTC", "success");
            gameData.balance += 2500;
            updateUI();
        }
        
        function claimCipher() {
            const cipher = generateCipher();
            const reward = Math.floor(Math.random() * 1500) + 500;
            
            showNotification(`üîê –®–∏—Ñ—Ä: ${cipher}\nüéØ –ù–∞–≥—Ä–∞–¥–∞: +${reward} MPTC`, "success");
            gameData.balance += reward;
            updateUI();
        }
        
        function activateBoost() {
            if (gameData.balance < 2500) {
                showNotification("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!", "error");
                return;
            }
            
            gameData.balance -= 2500;
            gameData.hourlyIncome *= 2;
            
            showNotification("‚ö° –ë—É—Å—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! 2x –¥–æ—Ö–æ–¥ –Ω–∞ 60 –º–∏–Ω—É—Ç!", "success");
            
            setTimeout(() => {
                gameData.hourlyIncome /= 2;
                updateUI();
                showNotification("üîö –ë—É—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω", "info");
            }, 3600000); // 1 —á–∞—Å
            
            updateUI();
        }
        
        function generateCipher() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        function checkRankUp() {
            if (gameData.rankProgress >= gameData.rankMax) {
                // –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞
                const ranks = ["Bronze", "Silver", "Gold", "Platinum", "Diamond"];
                const currentIndex = ranks.indexOf(gameData.rank);
                
                if (currentIndex < ranks.length - 1) {
                    gameData.rank = ranks[currentIndex + 1];
                    gameData.rankProgress = 1;
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ—Ö–æ–¥
                    const incomeMap = {
                        "Bronze": 93,
                        "Silver": 250,
                        "Gold": 600,
                        "Platinum": 15700,
                        "Diamond": 50000
                    };
                    
                    gameData.hourlyIncome = incomeMap[gameData.rank];
                    
                    showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ù–æ–≤—ã–π —Ä–∞–Ω–≥: ${gameData.rank}!`, "success");
                }
            } else {
                gameData.rankProgress++;
            }
        }
        
        function restoreEnergy() {
            if (gameData.energy < gameData.energyMax) {
                gameData.energy++;
                updateUI();
            }
        }
        
        function updateUI() {
            // –ë–∞–ª–∞–Ω—Å
            document.getElementById('balance').textContent = gameData.balance.toLocaleString();
            
            // –≠–Ω–µ—Ä–≥–∏—è
            const energyPercent = (gameData.energy / gameData.energyMax) * 100;
            document.getElementById('energyFill').style.width = `${energyPercent}%`;
            document.getElementById('energyText').textContent = 
                `${gameData.energy} / ${gameData.energyMax}`;
            
            // –†–∞–Ω–≥
            document.getElementById('rankText').textContent = 
                `${gameData.rank} ${gameData.rankProgress}/${gameData.rankMax}`;
            
            // –î–æ—Ö–æ–¥
            document.getElementById('hourlyIncome').textContent = 
                `+${gameData.hourlyIncome.toLocaleString()}`;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('totalClicks').textContent = gameData.totalClicks.toLocaleString();
            document.getElementById('rankProgress').style.width = 
                `${(gameData.rankProgress / gameData.rankMax) * 100}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç —Ä–∞–Ω–≥–∞
            updateRankColor();
        }
        
        function updateRankColor() {
            const rankColors = {
                "Bronze": "#CD7F32",
                "Silver": "#C0C0C0",
                "Gold": "#FFD700",
                "Platinum": "#E5E4E2",
                "Diamond": "#B9F2FF"
            };
            
            const badge = document.getElementById('rankBadge');
            badge.style.background = `linear-gradient(90deg, ${rankColors[gameData.rank]}, ${rankColors[gameData.rank]}80)`;
        }
        
        function updateTimers() {
            const now = new Date();
            
            // –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
            const dailyTime = new Date();
            dailyTime.setHours(14, 37, 0, 0);
            if (now > dailyTime) dailyTime.setDate(dailyTime.getDate() + 1);
            
            // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —à–∏—Ñ—Ä
            const cipherTime = new Date();
            cipherTime.setHours(9, 37, 0, 0);
            if (now > cipherTime) cipherTime.setDate(cipherTime.getDate() + 1);
            
            document.getElementById('dailyTimer').textContent = 
                formatTimeRemaining(dailyTime - now);
            document.getElementById('cipherTimer').textContent = 
                formatTimeRemaining(cipherTime - now);
        }
        
        function formatTimeRemaining(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
        
        function showFloatingText(text, x, y) {
            const floating = document.createElement('div');
            floating.textContent = text;
            floating.style.position = 'fixed';
            floating.style.left = x + 'px';
            floating.style.top = y + 'px';
            floating.style.color = '#00FF88';
            floating.style.fontWeight = 'bold';
            floating.style.fontSize = '1.2em';
            floating.style.pointerEvents = 'none';
            floating.style.zIndex = '1000';
            floating.style.textShadow = '0 2px 10px rgba(0, 255, 136, 0.5)';
            floating.style.animation = 'floatUp 1s ease-out forwards';
            
            document.body.appendChild(floating);
            
            setTimeout(() => floating.remove(), 1000);
        }
        
        function showNotification(message, type) {
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.background = type === 'error' ? '#FF3366' : 
                                          type === 'success' ? '#00CC6A' : '#6C63FF';
            notification.style.color = 'white';
            notification.style.padding = '15px 25px';
            notification.style.borderRadius = '10px';
            notification.style.zIndex = '10000';
            notification.style.boxShadow = '0 5px 20px rgba(0,0,0,0.3)';
            notification.style.animation = 'slideIn 0.3s ease-out';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out forwards';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        function showFriends() {
            showNotification("üë• –î–æ–±–∞–≤–ª—è–π—Ç–µ –¥—Ä—É–∑–µ–π —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞!", "info");
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes floatUp {
                0% { transform: translateY(0); opacity: 1; }
                100% { transform: translateY(-50px); opacity: 0; }
            }
            
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
"""

# ===== –ó–ê–ü–£–°–ö =====
async def main():
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("MPTHamst –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    await dp.start_polling()

if __name__ == '__main__':
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª
    with open('mpthamst_webapp.html', 'w', encoding='utf-8') as f:
        f.write(web_app_html)
    
    print("–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∫–∞–∫ mpthamst_webapp.html")
    print("–ó–∞–≥—Ä—É–∑–∏—Ç–µ –µ–≥–æ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥ –∏ —É–∫–∞–∂–∏—Ç–µ URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π WEBAPP_URL")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    asyncio.run(main())
